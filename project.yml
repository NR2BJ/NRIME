name: NRIME
options:
  bundleIdPrefix: com.nrime.inputmethod
  deploymentTarget:
    macOS: "13.0"
  xcodeVersion: "16.0"
  createIntermediateGroups: true
  generateEmptyDirectories: true

settings:
  base:
    SWIFT_VERSION: "5.9"
    MACOSX_DEPLOYMENT_TARGET: "13.0"

targets:
  NRIME:
    type: application
    platform: macOS
    sources:
      - path: NRIME
        excludes:
          - Resources/Info.plist
    settings:
      base:
        PRODUCT_BUNDLE_IDENTIFIER: com.nrime.inputmethod.app
        INFOPLIST_FILE: NRIME/Resources/Info.plist
        INSTALL_PATH: /Library/Input Methods
        SKIP_INSTALL: false
        # LSUIElement is set in Info.plist (allows NSStatusItem + windows)
        PRODUCT_NAME: NRIME
        COMBINE_HIDPI_IMAGES: true
        # No @main â€” we use main.swift
        # Disable automatic code signing for input methods
        CODE_SIGN_IDENTITY: "-"
        CODE_SIGNING_ALLOWED: false
    dependencies:
      - framework: InputMethodKit.framework
        embed: false
      - sdk: Carbon.framework
      - sdk: libsqlite3.tbd

  NRIMESettings:
    type: application
    platform: macOS
    sources:
      - path: NRIMESettings
    settings:
      base:
        PRODUCT_BUNDLE_IDENTIFIER: com.nrime.inputmethod.settings
        GENERATE_INFOPLIST_FILE: true
        PRODUCT_NAME: NRIMESettings
        CODE_SIGN_IDENTITY: "-"
        CODE_SIGNING_ALLOWED: false
        MACOSX_DEPLOYMENT_TARGET: "13.0"
    info:
      path: NRIMESettings/Info.plist
      properties:
        LSUIElement: true
    dependencies: []

  NRIMETests:
    type: bundle.unit-test
    platform: macOS
    sources:
      - path: NRIMETests
    settings:
      base:
        PRODUCT_BUNDLE_IDENTIFIER: com.nrime.inputmethod.app.tests
        GENERATE_INFOPLIST_FILE: true
        CODE_SIGN_IDENTITY: "-"
        CODE_SIGNING_ALLOWED: false
    dependencies:
      - target: NRIME
